<!DOCTYPE html>
<html>

<head>
	<title>Life River</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" type="text/css" href="assets/stylesheets/application.css">
	<link rel="stylesheet" type="text/css" href="assets/stylesheets/op-stylesheet.css">
	<link rel="stylesheet" type="text/css" href="assets/stylesheets/loadrr.css">
	<script src="assets/javascripts/jquery-2.1.4.min.js"></script>
	<script src="assets/javascripts/metroline.min.js#1"></script>

	<!-- favicon stuff -->
	<link rel="apple-touch-icon" sizes="57x57" href="/assets/images/favicons/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/assets/images/favicons/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/images/favicons/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/assets/images/favicons/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/images/favicons/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/assets/images/favicons/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/assets/images/favicons/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/assets/images/favicons/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon-180x180.png">
	<link rel="icon" type="image/png" href="/assets/images/favicons/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/assets/images/favicons/favicon-194x194.png" sizes="194x194">
	<link rel="icon" type="image/png" href="/assets/images/favicons/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/assets/images/favicons/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="/assets/images/favicons/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="/assets/images/favicons/manifest.json">
	<link rel="mask-icon" href="/assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
	<link rel="shortcut icon" href="/assets/images/favicons/favicon.ico">
	<meta name="msapplication-TileColor" content="#da532c">
	<meta name="msapplication-TileImage" content="/assets/images/favicons/mstile-144x144.png">
	<meta name="msapplication-config" content="/assets/images/favicons/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">

	<!-- Mobile compatibility -->
	<meta name="viewport" content="width=device-width, initial-scale=1">

</head>

<body>

	<!-- section n°1 -->
	<section data-title="Bienvenue!" class="fixed f1" id="bienvenue">
		<div data-fetch="https://vanil.bullenetwork.ch/items/liferiver_sections/1">
			<div class="loadrr">
				<div>
					<div></div>
					<div></div>
					<div></div>
					<div></div>
				</div>
			</div>
	</section>

	<section data-title="Présentation" class="scrolling s1" id="presentation">
		<div class="container" data-fetch="https://vanil.bullenetwork.ch/items/liferiver_sections/2">
			<div class="loadrr">
				<div>
					<div></div>
					<div></div>
					<div></div>
					<div></div>
				</div>
			</div>
	</section>

	<!-- scrollbar scaffold (do not touch!) -->
	<div id="scrollbar">
		<div id="scrollcursor">
		</div>
		<ul id="scrolllinks">
		</ul>
	</div>

</body>

<script>

	const queryString = window.location.search;
	const urlParams = new URLSearchParams(queryString);
	var lang = urlParams.get("lang")
	if (lang === null && (lang != "en" || lang != "de")) {
		lang = "fr"
	}

	var contentField = "content"
	if (lang !== "fr") {
		contentField = contentField + "_" + lang
	}

	const boxPadding = 300;
	const maxRetry = 3;
	const waitFetch = 10;
	document.querySelectorAll('[data-fetch]').forEach((el, id) => {
		const url = el.dataset.fetch
		const checkLoad = function () {
			var position = el.getBoundingClientRect();
			// checking for partial visibility
			if (position.top < window.innerHeight + boxPadding && position.bottom >= -boxPadding) {
				window.removeEventListener('scroll', checkLoad);
				fetch(url).then((resp) => {
					return resp.json();
				}).then((data) => {
					el.innerHTML = data.data[contentField]
				});
			}
		}
		checkLoad();
		window.addEventListener('scroll', checkLoad);
	});

	// fire metroline
	$(window).load(function () { new Metroline(); });

</script>

</html>